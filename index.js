import x509 from './x509.js';

const header = `-----BEGIN CERTIFICATE----- MIIIlzCCCD2gAwIBAgIRAMvURZGMQkPqoFqmAilLxJcwCgYIKoZIzj0EAwIwgYQx KzApBgoJkiaJk/IsZAEBDBtpZGVudGl0eTppZG1zLmdyb3VwLjU1MDQ0ODcxLTAr BgNVBAMMJGFwcGF1dGhvcml0eTAwNC5jbmd5YTA1LnBpZS5zaWx1Lm5ldDEmMCQG A1UECwwdbWFuYWdlbWVudDppZG1zLmdyb3VwLjE0MDUyMDYwHhcNMjQwNzAxMTkw MzA0WhcNMjQwNzExMTkwODA0WjCB9DELMAkGA1UEBhMCVVMxJzAlBgNVBAsMHm1h bmFnZW1lbnQ6aWRtcy5ncm91cC4xMDg2MjcwNDETMBEGA1UECwwKY24tZWFzdC0x ZTEtMCsGA1UEAwwkNzY5MTU3YmEtNWQ4Mi00MDk2LThlNGQtOGYxY2E2M2U0NThl MSwwKgYKCZImiZPyLGQBAQwcaWRlbnRpdHk6aWRtcy5ncm91cC4xMTEzMzE4NDEh MB8GA1UECwwYb3duZXI6aWRtcy5ncm91cC41NTQ4MzE2MScwJQYDVQQKDB5tYW5h Z2VtZW50OmlkbXMuZ3JvdXAuMTA4NjI3MDQwWTATBgcqhkjOPQIBBggqhkjOPQMB BwNCAARjFEFwiL3H0IVk/Jv5pAQZXnf5qyx3nrkRzbrWrlaI6EmfkmMU+ADdLwtF 726ZLxoxVFKQmNpaMcwwd1rrWB8to4IGHDCCBhgwggN1BgNVHREEggNsMIIDaII2 Y2Fib29kbGUtZ2F0ZWtlZXBlci1nY2JkLmNhYm9vZGxlLWdhdGVrZWVwZXItZ2Ni ZC5rdWJlgkcqLmNhYm9vZGxlLWdhdGVrZWVwZXItZ2NiZC5jYWJvb2RsZS1nYXRl a2VlcGVyLWdjYmQua3ViZS5jbG91ZC5zaWx1Lm5ldIZ7Zmx1ZmZ5Oi8vY2Fib29k bGUtZ2F0ZWtlZXBlci1nY2JkLmNhYm9vZGxlLWdhdGVrZWVwZXItZ2NiZC5rdWJl LjE0MDUyMDYvb3duZXI9NTU0ODMxNi9tYW5hZ2VtZW50PTEwODYyNzA0L2lkZW50 aXR5PTExMTMzMTg0hwSsFQ4GhxAkAvFAEBABpgAAAAAAAAAGhwSsFQ4GhwSsESXo hxAkAvFAEComBgAAAAAAACG0hwSsFrP5glRjYWJvb2RsZS1nYXRla2VlcGVyLWdj YmQuY2Fib29kbGUtZ2F0ZWtlZXBlci1nY2JkLmt1YmUuY24tZWFzdC0xZS5rOHMu Y2xvdWQuc2lsdS5uZXSCPWNhYm9vZGxlLWdhdGVrZWVwZXItc2VydmljZS1nY2Jk LmNhYm9vZGxlLWdhdGVrZWVwZXItZ2NiZC5zdmOCYGNhYm9vZGxlLWdhdGVrZWVw ZXItc2VydmljZS1nY2JkLmNhYm9vZGxlLWdhdGVrZWVwZXItZ2NiZC5zdmMua3Vi ZS5jbi1lYXN0LTFlLms4cy5jbG91ZC5zaWx1Lm5ldIJiKi5jYWJvb2RsZS1nYXRl a2VlcGVyLXNlcnZpY2UtZ2NiZC5jYWJvb2RsZS1nYXRla2VlcGVyLWdjYmQuc3Zj Lmt1YmUuY24tZWFzdC0xZS5rOHMuY2xvdWQuc2lsdS5uZXSCeWNhYm9vZGxlLWdh dGVrZWVwZXItZ2NiZC5jYWJvb2RsZS1nYXRla2VlcGVyLXNlcnZpY2UtZ2NiZC5j YWJvb2RsZS1nYXRla2VlcGVyLWdjYmQuc3ZjLmt1YmUuY24tZWFzdC0xZS5rOHMu Y2xvdWQuc2lsdS5uZXSCVmNhYm9vZGxlLWdhdGVrZWVwZXItZ2NiZC5jYWJvb2Rs ZS1nYXRla2VlcGVyLXNlcnZpY2UtZ2NiZC5jYWJvb2RsZS1nYXRla2VlcGVyLWdj YmQuc3ZjMIIBjwYJKwYBBAE/hWcBBIIBgASCAXwKNmNhYm9vZGxlLWdhdGVrZWVw ZXItZ2NiZC5jYWJvb2RsZS1nYXRla2VlcGVyLWdjYmQua3ViZRIKY24tZWFzdC0x ZRqzAQgAEAAYACAAKAAwADgAQABKJAoKY24tZWFzdC0xZRIUcGxiLnBpZS1wbGIu cGllLXByb2QYAEokCgpjbi1lYXN0LTFlEhRrbm9kZTA1NzYuY25neWEwNS5raxgB YhgSFC5jYWJvb2RsZS1wcm94eS5rdWJlGABqFlBJRSBWSVAgJiBCR1AgTmV0d29y a3N4AIABAIoBHQoDU0RSEhZQSUUgVklQICYgQkdQIE5ldHdvcmtzIggIABAAGAAw ADI2Y2Fib29kbGUtZ2F0ZWtlZXBlci1nY2JkLmNhYm9vZGxlLWdhdGVrZWVwZXIt Z2NiZC5rdWJlMj5jYWJvb2RsZS1nYXRla2VlcGVyLXNlcnZpY2UtZ2NiZC5jYWJv b2RsZS1nYXRla2VlcGVyLWdjYmQua3ViZTAvBgkrBgEEAT+FZwMEIgQgZW50aXRs ZW1lbnRzLnByb2R1Y3Rpb24ucGxhdGZvcm0wJgYJKwYBBAE/hWcCBBkEF3NjaGVk dWxlc2lnbmVyLmt1YmUucGllMBkGCSsGAQQBP4VnCAQMBApjbi1lYXN0LTFlMBkG CSsGAQQBP4VnCQQMDApjbi1lYXN0LTFlMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/ BAQDAgOoMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATAdBgNVHQ4EFgQU y4KX227jqWQ/Njq9Uvlef70C/QIwHwYDVR0jBBgwFoAUdLWEy0Pd//HPJoMVgiTt bhd3c4QwCgYIKoZIzj0EAwIDSAAwRQIgLhHz+8j/1h69mmiTjI0G9fi1T0a/A1Y7 PnLFXIRT198CIQDilFkRZ+Whk1drHncXldLDdk0+ioK7InRqNiyv6Gydrg== -----END CERTIFICATE-----`;

try {
  let s = 'SANs:\n';
  let sans = x509.get_san(x509.header2pem(header), 0, false);
  for (let i = 0; i<sans.length; i++) {
    s += sans[i] + '\n';
  } 
  console.log(s);
} catch(err) {
  console.log(err);
}
